CREATE SCHEMA IF NOT EXISTS BDEX4_ESTOQUE;
USE BDEX4_ESTOQUE;

CREATE TABLE IF NOT EXISTS PRODUTOS(
ID_PRODUTO INT PRIMARY KEY,
NOME VARCHAR(100) NOT NULL,
DESCRICAO TEXT NOT NULL,
PRECO DECIMAL(10,2) NOT NULL
);

CREATE TABLE IF NOT EXISTS FORNECEDORES(
ID_FORNECEDOR INT PRIMARY KEY,
CNPJ VARCHAR(20) NOT NULL,
NOME VARCHAR(100) NOT NULL,
CIDADE VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS ARMAZENS(
ID_ARMAZEM INT PRIMARY KEY,
NOME_ARMAZEM VARCHAR(100) NOT NULL,
LOG_ARMAZEM VARCHAR(100) NOT NULL,
NUMLOG_ARMAZEM INT,
BAIRRO_ARMAZEM VARCHAR(100) NOT NULL,
CIDADE_ARMAZEM VARCHAR(100) NOT NULL,
UF_ARMAZEM CHAR(2) NOT NULL);

CREATE TABLE IF NOT EXISTS PEDIDOS_COMPRA(
ID_PEDIDO INT PRIMARY KEY,
DATA_PEDIDO DATE NOT NULL,
HORA_PEDIDO TIME NOT NULL,
FORNECEDOR INT NOT NULL,
CONSTRAINT FORNECEDOR_PEDIDO FOREIGN KEY(FORNECEDOR) 
REFERENCES FORNECEDORES(ID_FORNECEDOR));

CREATE TABLE IF NOT EXISTS PRODUTOS_FORNECEDORES(
PRODUTO INT,
FORNECEDOR INT,
PRIMARY KEY(PRODUTO,FORNECEDOR),
CONSTRAINT PROD_FORN FOREIGN KEY(PRODUTO) REFERENCES PRODUTOS(ID_PRODUTO),
CONSTRAINT FORN_PROD FOREIGN KEY(FORNECEDOR) REFERENCES FORNECEDORES(ID_FORNECEDOR)
);

CREATE TABLE IF NOT EXISTS PRODUTOS_ARMAZENS(
PRODUTO INT,
ARMAZEM INT,
PRIMARY KEY(PRODUTO,ARMAZEM),
CONSTRAINT PROD_ARMZ FOREIGN KEY(PRODUTO) REFERENCES PRODUTOS(ID_PRODUTO),
CONSTRAINT ARMZ_PROD FOREIGN KEY(ARMAZEM) REFERENCES ARMAZENS(ID_ARMAZEM));

ALTER TABLE PRODUTOS_ARMAZENS
ADD QUANTIDADE INT NOT NULL;